{% extends "base.html" %}

{% block title %}Add Email Account - MailMind AI{% endblock %}

{% block page_title %}Add Email Account{% endblock %}

{% block breadcrumb %}
<li class="breadcrumb-item"><a href="{{ url_for('list_accounts') }}">Email Accounts</a></li>
<li class="breadcrumb-item active">Add</li>
{% endblock %}

{% block content %}
<section class="section">
  <div class="row">
    <div class="col-lg-8">

      <div class="card">
        <div class="card-body">
          <h5 class="card-title">New Email Account</h5>

          <!-- Multi Columns Form -->
          <form class="row g-3" method="POST" action="{{ url_for('add_account') }}">
            <div class="col-md-12">
              <label for="email_address" class="form-label">Email Address</label>
              <input type="email" class="form-control" id="email_address" name="email_address" required>
            </div>
            <div class="col-md-8">
              <label for="host" class="form-label">Host</label>
              <input type="text" class="form-control" id="host" name="host" required placeholder="imap.example.com">
            </div>
            <div class="col-md-4">
              <label for="port" class="form-label">Port</label>
              <input type="number" class="form-control" id="port" name="port" required min="1" max="65535" value="993">
            </div>
            <div class="col-md-12">
              <label for="username" class="form-label">Username</label>
              <input type="text" class="form-control" id="username" name="username" required>
            </div>
            <div class="col-md-12">
              <label for="password" class="form-label">Password</label>
              <input type="password" class="form-control" id="password" name="password" required>
            </div>
            <div class="col-md-6">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="use_ssl" name="use_ssl" checked>
                <label class="form-check-label" for="use_ssl">
                  Use SSL (Port 993)
                </label>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="use_tls" name="use_tls">
                <label class="form-check-label" for="use_tls">
                  Use TLS (Port 143)
                </label>
              </div>
            </div>
            <div class="text-center">
              <button type="submit" class="btn btn-primary">Add Account</button>
              <a href="{{ url_for('list_accounts') }}" class="btn btn-secondary">Cancel</a>
            </div>
          </form><!-- End Multi Columns Form -->

        </div>
      </div>

    </div>
  </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
  // Auto-update port based on SSL/TLS selection
  document.getElementById('use_ssl').addEventListener('change', function() {
    if (this.checked) {
      document.getElementById('use_tls').checked = false;
      document.getElementById('port').value = 993;
    }
  });

  document.getElementById('use_tls').addEventListener('change', function() {
    if (this.checked) {
      document.getElementById('use_ssl').checked = false;
      document.getElementById('port').value = 143;
    }
  });
</script>
{% endblock %}
